<div>
    <div fxLayout="row">
        <mat-form-field fxFlex>
            <input matInput [(ngModel)]="fsAddress[fsAddressConfig.address.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.address.required" name="{{ fsAddressConfig.address.id }}" placeholder="Address" aria-label="Address" (change)="search()">
        </mat-form-field>
        <mat-form-field fxFlex [hidden]="!fsAddressConfig.address2.show">
            <input matInput [(ngModel)]="fsAddress[fsAddressConfig.address2.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.address2.required" name="{{ fsAddressConfig.address2.id }}" placeholder="Address 2" aria-label="Address 2" (change)="search()">
            <mat-hint>Apartment, suite, unit, building, floor, etc.</mat-hint>
        </mat-form-field>
    </div>

    <div fxLayout="row">
        <mat-form-field fxFlex>
            <input matInput [(ngModel)]="fsAddress[fsAddressConfig.city.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.city.required" name="{{ fsAddressConfig.city.id }}" placeholder="City" aria-label="City" (change)="search()">
        </mat-form-field>
        <mat-form-field fxFlex>
            <input matInput [(ngModel)]="fsAddress[fsAddressConfig.zip.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.zip.required" name="{{ fsAddressConfig.zip.id }}" placeholder="{{ zipLabel }}" (change)="search()">
        </mat-form-field>
    </div>

    <div fxLayout="row">
        <mat-form-field fxFlex>
            <mat-select [(ngModel)]="fsAddress[fsAddressConfig.country.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.country.required" name="{{ fsAddressConfig.country.id }}" placeholder="Country" aria-label="Country" (ngModelChange)="changeCountry()" (change)="search()">
                <mat-option *ngFor="let country of countries.domestic" [value]="country.code">
                    <span>{{ country.name }}</span>
                </mat-option>
                <ng-container *ngIf="countries.international.length">
                    <mat-option *ngFor="let country of countries.international" [value]="country.code">
                        <span>{{ country.name }}</span>
                    </mat-option>
                </ng-container>
            </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex>
            <mat-select [(ngModel)]="fsAddress[fsAddressConfig.region.name]" [attr.disabled]="fsAddressConfig.disabled" [fsFormRequired]="fsAddressConfig.region.required" name="{{ fsAddressConfig.region.id }}" placeholder="{{ regionLabel }}" (change)="search()">
                <mat-option *ngFor="let region of regions" [value]="region.code">
                    <span>{{ region.name }}</span>
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>

    <div class="map-container" [hidden]="!fsAddressConfig.map">

        <button mat-button class="center" 
        *ngIf="(fsAddress.lat && fsAddress.lng) && (marker.coords.latitude && marker.coords.longitude)" 
        (click)="recenter()">Center Map using Address</button>

        <agm-map 
        [latitude]="map.center.latitude" 
        [longitude]="map.center.longitude"
        [zoom]="map.zoom"
        [scrollwheel]="mapOptions.scrollwheel"
        [streetViewControl]="mapOptions.streetViewControl"
        [mapTypeControlOptions]="mapOptions.mapTypeControlOptions"
        >
            <agm-marker 
            [latitude]="marker.coords.latitude" 
            [longitude]="marker.coords.longitude"
            [markerDraggable]="marker.options.draggable"
            (dragEnd)="marker.events.dragend($event)"
            ></agm-marker>
        </agm-map>

        <div class="address-incomplete" fxLayout="row" fxLayoutAlign="center center" *ngIf="!fsAddress.lat && !fsAddress.lng">
            <div *ngIf="!searched">Please populate the address above to locate it on the map</div>
            <div *ngIf="searched">Could not find address "{{ searchedAddress }}"</div>
        </div>
    </div>
</div>
